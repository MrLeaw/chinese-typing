<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinese Zhuyin Typing Trainer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', 'Hiragino Sans GB', sans-serif;
            background-color: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-unit {
            font-size: 0.8em;
            color: #999;
        }

        .stat-value.speed { color: #3b82f6; }
        .stat-value.accuracy { color: #10b981; }
        .stat-value.time { color: #8b5cf6; }
        .stat-value.progress { color: #f59e0b; }

        .text-selector {
            margin-bottom: 30px;
        }

        .text-selector label {
            display: block;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .text-selector select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            background: white;
        }

        .text-selector select:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .text-display {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            line-height: 2.5;
            font-size: 1.4em;
            letter-spacing: 0.1em;
        }

        .char-correct {
            background-color: #dcfce7;
            color: #166534;
        }

        .char-incorrect {
            background-color: #fef2f2;
            color: #dc2626;
        }

        .char-current {
            background-color: #dbeafe;
            border-bottom: 3px solid #3b82f6;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .input-area {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .input-area label {
            display: block;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .input-area textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.2em;
            resize: none;
            font-family: 'Microsoft JhengHei', 'PingFang TC', 'Hiragino Sans GB', sans-serif;
            line-height: 1.6;
        }

        .input-area textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .input-area textarea:disabled {
            background-color: #f9fafb;
            cursor: not-allowed;
        }

        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-primary {
            background-color: #3b82f6;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background-color: #2563eb;
        }

        .btn-secondary {
            background-color: #6b7280;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background-color: #4b5563;
        }

        .instructions {
            background: #eff6ff;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #3b82f6;
        }

        .instructions h3 {
            color: #1e40af;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .instructions ul {
            color: #1e40af;
            list-style: none;
        }

        .instructions li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .instructions li:before {
            content: "•";
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .text-display {
                font-size: 1.2em;
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>中文注音打字練習</h1>
            <p>Chinese Zhuyin Typing Trainer</p>
        </div>

        <!-- Stats Panel -->
        <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-label">Speed</div>
                <div class="stat-value speed" id="wpm">0</div>
                <div class="stat-unit">CPM</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Accuracy</div>
                <div class="stat-value accuracy" id="accuracy">100%</div>
                <div class="stat-unit">Correct</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Time</div>
                <div class="stat-value time" id="time">0:00</div>
                <div class="stat-unit">Elapsed</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Progress</div>
                <div class="stat-value progress" id="progress">0%</div>
                <div class="stat-unit">Complete</div>
            </div>
        </div>

        <!-- Difficulty Selection -->
        <div class="text-selector">
            <label for="difficultySelector">選擇難度等級 (Select Difficulty Level)</label>
            <select id="difficultySelector">
                <option value="0">初級 (Beginner)</option>
                <option value="1">中級 (Intermediate)</option>
                <option value="2">高級 (Advanced)</option>
                <option value="3">專家級 (Expert)</option>
                <option value="4">母語/學術級 (Native/Academic)</option>
            </select>
        </div>

        <!-- Text Display -->
        <div class="text-display" id="textDisplay"></div>

        <!-- Input Area -->
        <div class="input-area">
            <label for="userInput">請使用注音輸入法輸入 (Type using Zhuyin IME)</label>
            <textarea 
                id="userInput" 
                rows="4" 
                placeholder="在這裡輸入中文字符..."
                disabled
            ></textarea>
        </div>

        <!-- Control Buttons -->
        <div class="controls">
            <button id="startBtn" class="btn btn-primary">
                開始練習 (Start)
            </button>
            <button id="resetBtn" class="btn btn-secondary">
                重新開始 (Reset)
            </button>
        </div>

        <!-- Instructions -->
        <div class="instructions">
            <h3>使用說明 (Instructions)</h3>
            <ul>
                <li>請確保您的系統已啟用注音輸入法</li>
                <li>看著上方的中文文本，使用注音輸入法在下方文本框中輸入</li>
                <li>系統會自動計算您的打字速度和準確率</li>
                <li>完成後可以選擇其他文本繼續練習</li>
            </ul>
        </div>
    </div>

    <script>
        // Sample texts for practice
         const practiceTextsByDifficulty = [
            // Level 0: Beginner
            [
                "大家好，我叫李明。我來自美國，現在住在臺北。我是一名英文老師。我的學校很大，學生都很可愛。我喜歡臺灣，因為臺灣人很友善，食物也很好吃。我最喜歡吃牛肉麵和珍珠奶茶。我正在學中文，我覺得中文有一點難，特別是寫字。我的愛好是看電影和聽音樂。很高興認識你們。",
                "我每天早上七點起床。起床以後，我先喝一杯水，然後做早餐。我通常吃麵包和雞蛋。八點半，我坐捷運去公司上班。我的工作很有意思。中午我和同事一起吃午飯。我們常常去公司附近的餐廳。下午五點我下班回家。晚上我喜歡在家看書或是跟朋友聊天。我大概十一點睡覺。",
                "老闆，你好。請問這個西瓜多少錢一斤？看起來很甜。好的，那我要買一個。另外，我還想買一些蘋果和香蕉。蘋果要五個，香蕉要一串。這裡的水果都很新鮮。對了，現在是芒果的季節嗎？如果是的話，我也想買兩個。謝謝你。總共多少錢？這是一千塊，請找錢。",
                "我的家有四個人：爸爸、媽媽、哥哥和我。我爸爸是醫生，媽媽是家庭主婦。哥哥是大學生，他學電腦。我們家有一隻很可愛的貓，牠叫「咪咪」。我們都很愛牠。週末的時候，我們全家常常一起去公園散步，或者在家裡看電視。我愛我的家。",
    "今天天氣很好，是晴天，也很溫暖。我跟朋友約好下午三點要去喝咖啡。那家咖啡店很有名，聽說他們的蛋糕特別好吃。我打算點一杯拿鐵和一塊巧克力蛋糕。我們會在那裡聊天，談談最近的工作和生活。我很期待這次的下午茶約會。",
    "我最喜歡的運動是打籃球。每個星期六下午，我都會和同學去學校的籃球場打球。打籃球可以讓我忘掉煩惱，也對身體很好。我的偶像是麥可·喬丹，我覺得他打球非常厲害。雖然我打得沒有他那麼好，但是我享受跟朋友一起在球場上流汗的感覺。",
    "昨天是我的生日，我收到很多禮物和卡片，非常開心。晚上，我的家人帶我去一家義大利餐廳吃飯慶祝。我們點了披薩和義大利麵，味道都很棒。爸爸還為我準備了一個生日驚喜，是一個很大的水果蛋糕。我許了三個願望，希望它們都能實現。",
    "我想去商店買一件新衣服。我需要一件冬天的外套，因為天氣變冷了。我喜歡藍色的衣服，也希望外套有帽子。我會先坐公車去市中心的百貨公司看看。如果找不到喜歡的，我會再去附近的服飾店找找。希望今天可以買到一件又好看又保暖的外套。"
            ],
            // Level 1: Intermediate
            [
                "這個週末我打算和幾個朋友去陽明山走走。我們聽說最近天氣不錯，山上的風景應該會很漂亮。我們計畫早上搭公車上山，先去擎天崗看牛，然後沿著步道散步，享受大自然。中午我們會自己帶些簡單的三明治當午餐。因為我對攝影很有興趣，所以一定會帶相機去，希望能拍到一些滿意的照片。如果下山後還有時間，我們或許會去士林夜市逛逛，吃點道地的小吃。",
                "隨著工業發展，環境污染的問題變得越來越嚴重。無論是空氣污染、水污染，還是塑膠廢棄物，都對我們的地球造成了巨大的負擔。因此，實行環保生活是我們每個人的責任。我們可以從身邊的小事做起，例如隨手關燈、節約用水、做好垃圾分類，並且多使用環保袋，減少一次性塑膠製品。雖然個人的力量有限，但只要大家一起努力，就能為保護地球貢獻一份心力。",
                "我上週去看了一部廣受好評的懸疑電影。故事的結構非常巧妙，從一開始就營造出緊張的氣氛，讓觀眾完全投入其中。導演運用了許多非線性的敘事手法，不斷地在過去和現在之間切換，使得劇情更加撲朔迷離。演員的表現也相當出色，尤其主角把內心的掙扎與恐懼詮釋得淋漓盡致。電影的結局更是出人意料，顛覆了所有之前的猜測。總而言之，這是一部值得推薦的佳作。",
                "上個週末，我參加了一場路跑活動。為了準備這場比賽，我提前兩個月就開始進行規律的訓練，從短距離慢慢增加到十公里。比賽當天，雖然天氣有些炎熱，但沿途的風景和民眾的加油聲給了我很大的鼓勵。當我衝過終點線的那一刻，儘管筋疲力盡，內心卻充滿了成就感。這次經驗讓我體會到，只要堅持不懈，就能超越自我。",
    "隨著網路科技的普及，線上購物已成為許多人生活中不可或缺的一部分。它最大的優點在於方便快捷，消費者足不出戶就能瀏覽各式商品，並享受送貨到府的服務。然而，線上購物也存在一些缺點，例如無法親身體驗商品品質，以及可能面臨個人資料外洩的風險。因此，消費者在享受便利的同時，也應該保持警惕。",
    "我對臺灣的傳統市場情有獨鍾。那裡不僅販售著最新鮮的蔬果漁獲，更充滿了濃厚的人情味。攤販們熱情的叫賣聲、顧客們討價還價的對話，交織成一幅生動活潑的生活畫卷。每次去逛市場，我總喜歡和老闆們聊上幾句，聽聽他們的故事。這種親切的互動，是在現代化超市裡難以感受到的溫暖體驗。",
    "學習一門新語言的過程，就如同開啟一扇通往新世界的大門。起初可能會因為陌生的發音和複雜的文法而感到挫折，但只要持之以恆，就會逐漸發現其中的樂趣。當你能夠用新語言與當地人溝通，或是看懂一部沒有字幕的電影時，那種喜悅是難以言喻的。語言不僅是溝通的工具，更是理解不同文化的橋梁。",
    "我的家鄉是一個寧靜的濱海小鎮。記憶中，小鎮的步調總是緩慢而悠閒。夏日的午後，我喜歡到海邊的防波堤上散步，聽著海浪拍打岸邊的聲音，感受海風輕拂臉龐。傍晚時分，夕陽將整片海面染成金黃色，漁船三三兩兩地返航，構成一幅美麗的圖畫。雖然長大後我到大城市工作，但家鄉的這片海景，始終是我心中最平靜的角落。"
            ],
            // Level 2: Advanced
            [
                "現代都市猶如一頭永不歇息的巨獸，白日裡車水馬龍，夜晚則霓虹璀璨。人們在這片鋼筋水泥的叢林中奔波，為生活、為理想而奮鬥。然而，喧囂背後，這座城市亦有其靜謐的角落。或許是清晨公園裡打太極拳的長者，或許是隱身巷弄的獨立書店，又或許是黃昏時分，夕陽餘暉灑滿的河濱。在這些時刻，城市的節奏彷彿慢了下來，讓人得以喘息，重新審視內心，尋回那份久違的平靜與歸屬感。",
                "沉浸於書海之中，無異於進行一場跨越時空的深度對話。文字作為思想的載體，能引領我們窺探先哲的智慧，體悟不同時代的文化脈動。一本好書，或能啟迪心智，或能撫慰靈魂。當我們與書中人物共歷悲歡，隨作者的思緒遊走於奇妙的境地，世俗的煩惱似乎也隨之消散。這種純粹的精神享受，是其他娛樂方式難以比擬的。故曰，讀書之樂，樂在心領神會，樂在自我昇華。",
                "人工智能的崛起，正以前所未有的深度與廣度，重塑著人類社會的樣貌。從自動駕駛到醫療診斷，其應用已滲透至各行各業，極大提升了生產效率。然而，這項顛覆性的技術也帶來了諸多挑戰，例如大規模的失業風險、演算法的偏見問題，以及數據隱私與倫理的困境。我們正站在一個關鍵的十字路口，如何善用AI的潛力，同時建立健全的規範以防範其弊端，將是全人類刻不容緩的共同課題。",
                "中國的茶文化源遠流長，博大精深。品茗不僅是解渴的生理需求，更昇華為一種生活美學與心靈修養。從茶葉的揀選、水質的講究，到茶具的搭配與沖泡的技法，每一個環節都蘊含著深厚的學問。在一個靜謐的午後，約三五好友，圍坐一席，沏上一壺好茶，茶香裊裊，滌盡塵囂。透過品茗，人們得以在繁忙的俗世中，覓得片刻的寧靜與自省。",
    "當代社會面臨著日益嚴峻的世代隔閡問題。由於成長背景、價值觀念及科技運用的巨大差異，不同世代之間往往難以進行有效的溝通與理解。年輕一代追求創新與個人自由，而老一輩則更重視傳統與穩定。這種觀念上的衝突，若不加以正視與調和，極易引發家庭矛盾與社會對立。建立跨世代的對話平台，促進相互尊重與包容，實為當務之急。",
    "傳統節慶是民族文化傳承的重要載體。以春節為例，它不僅僅是家人團聚的時刻，其背後更承載著豐富的文化意涵。從貼春聯、放鞭炮的除舊佈新，到祭祀祖先的慎終追遠，再到發壓歲錢的祝福期許，每一個習俗都凝聚了先民的智慧與情感。然而，在現代化的浪潮中，許多傳統儀式逐漸簡化甚至式微，如何使其在當代社會煥發新生，是值得我們深思的課題。",
    "許多人嚮往「說走就走」的旅行，認為那代表著無拘無束的自由。然而，一趟規劃周詳的旅程，自有其無可取代的魅力。詳盡的行前研究，能讓你更深入地了解目的地的歷史文化，避免走馬看花式的遊覽。合理的行程安排，則能讓你在有限的時間內，獲得最豐富的體驗。旅行的意義不僅在於沿途的風景，更在於事前那份充滿期待的規劃過程。",
    "書法藝術的精髓在於透過筆墨線條，展現書寫者的內在精神與氣韻。它並非單純的寫字，而是一種結合了技巧、情感與哲思的綜合表現。王羲之的《蘭亭序》，行筆流暢，氣韻生動，被譽為「天下第一行書」。欣賞書法時，觀者不僅能感受到文字的結構美，更能從筆畫的提按頓挫、墨色的濃淡乾濕中，體會書家創作當下的心境。這便是書法藝術引人入勝之處。"
            ],
            // Level 3: Expert
            [
                "秋氣蕭瑟，獨自彳亍於寂寥古道，看落葉蹣跚，隨風飄零。天穹高遠而湛藍，宛若一泓不起漣漪的清潭。遠山含黛，近水無言，萬物皆在凋敝中顯露其本真面目。此情此景，易引人愁思，然細品之下，未嘗不是一種侘傺之美。生命由絢爛歸於平淡，恰如這季節的更迭，蘊含著一種循環往復的哲理。人生在世，何嘗不似這秋葉，終將齎志而歿，歸於塵土？",
                "藝術之真諦，非在於纖毫畢現之摹寫，亦非純粹情感之宣洩，而在於捕捉那稍縱即逝之神韻與靈光。高明之藝術家，能以其獨特之慧眼，於平凡事物中洞見不凡，於剎那間凝住永恆。其作品或如晨鐘暮鼓，發人深省；或如空谷幽蘭，沁人心脾。觀者與作品交感之際，心靈得以滌蕩，境界得以提升。此種超越言筌的共鳴，正是藝術所以為藝術之精髓所在。",
                "探究歷史長河，常令人陷入偶然與必然的思辨。王朝之興替，英雄之崛起，看似皆有其必然的社會經濟背景與文化基因。然於關鍵節點，一場突如其來的瘟疫、一次偶然的軍事決策，或某位人物的性格缺陷，卻又可能如蝴蝶效應般，徹底扭轉歷史的軌跡。歷史彷彿在宏大的必然規律框架下，為無數微小的偶然性留下了恣意舞蹈的空間，其複雜與魅力，正在於此。",
                 "獨坐幽篁，月色如水，泠泠琴音劃破四野的寂靜。塵世的紛擾與俗務的羈絆，在此刻皆如輕煙般消散。莊周夢蝶，不知是蝶化為人，抑或人化為蝶，物我之辨，於此已然模糊。人生在世，不過百年倏忽，汲汲於功名利祿，何異於夏蟲語冰？不如放下執念，與山川星月為伍，浸淫於自然的大道之中，方能覓得真正的逍遙與怃慰。",
    "歷史洪流，浩浩湯湯，多少英雄豪傑，最終亦不過是浪花淘盡。觀史如觀棋，一步之差，或可致滿盤皆輸。然勝敗豈是定數？其中充滿了無數的偶然與變數。昔日垓下之圍，項羽若渡烏江，或有捲土重來之機，然其一念之差，選擇自刎，遂使天下歸漢。此等抉擇，既是性格使然，亦是時勢所趨。撫今追昔，怎不令人扼腕長嘆？",
    "美學之探討，其圭臬何在？或曰和諧，或曰崇高。然以余觀之，殘缺與無常之中，亦存侘寂之美。譬如古寺之斑駁牆垣，承載歲月之蝕刻；又如秋日之枯荷聽雨，聲聲皆是蕭索，卻也聲聲敲入心扉。完美無瑕之物，常流於匠氣，失卻靈魂。反倒是那些不完美之處，為想像留下了餘地，引人深思，其意藴之深遠，遠非圓滿之物可比擬。",
    "書齋乃文人安身立命之所。一几一椅，一筆一硯，看似簡素，卻是其精神世界之全部寄託。在此方寸天地間，可與古人神交，可與自我對話。窗外車馬喧囂，於我何干？書中自有千鍾粟，亦有顏如玉，更有宇宙之大，萬物之理。當夜闌人靜，孤燈一盞，展卷閱讀，墨香縈繞，此種樂趣，非身在其中者，實難以言喻其萬一。",
    "人際交往，猶如霧中行舟，彼此試探，互有藏掖。肺腑之言，鮮矣；逢場作戲，多矣。故知己之難得，自古皆然。所謂知己，非朝夕相處、齮齕不存者，而在於精神層次之契合，無需言語，一個眼神便能心領神會。伯牙摔琴謝知音，其情之真，其意之切，千載之下，依然動人心魄。人生若得一知己，縱使散落天涯，亦不感孤寂。"
            ],
            // Level 4: Native/Academic
            [
                "古籍之校勘，乃考據學之肯綮。一部典籍，歷經傳抄刊刻，訛誤增刪在所難免。校勘者之責，在於窮盡版本，比勘異同，溯其源流，以還其廬山真面目。此間功夫，非僅為辨識魯魚亥豕之誤，更需洞察時代之筆諱、書手之譌體，乃至後人之臆補。或有古字湮沒，為蠹魚所噬，僅存闕文，此時則需憑藉上下文與聲韻訓詁之學，審慎推求。此道甚艱，然為往聖繼絕學，雖千萬人吾往矣。",
                "商周青銅器之饕餮紋，其形詭譎，其意古奧，向為學界聚訟之焦點。其紋飾由簡至繁，由抽象至具象，演變軌跡清晰可辨。早期多為簡化之獸面，至商晚期則臻於繁縟，雙目圓睜，巨口獠牙，有吞噬天地之勢。究其意涵，或以為乃上古圖騰之孑遺，或以為象徵溝通天地之巫覡神獸。結合甲骨卜辭與祭祀禮制考之，饕餮或為一警示性符號，既代表對神明之敬畏，亦用以威嚇魑魅魍魎，以蠡測先民宇宙觀之一斑。",
                "《莊子·齊物論》乃道家思想之瓌寶。其核心要旨，在於破除人為的是非、彼此、大小之別，達至物我兩忘之境界。「天地與我並生，而萬物與我為一」，此非泯滅差異，而是超越對立的二元思維。當代社會，紛爭不斷，根源常在於固執己見，以自我為中心。莊子之智慧，恰可作一劑清涼散。若能從「道」之高度俯瞰，則一切價值判斷皆具相對性。體悟此理，方能放下執念，以逍遙之心，游刃於紛繁塵世。",
                "治經之學，首重訓詁，次及義理。蓋文字為思想之津逮，若不能精確把握字詞之本義與引申義，則對經典之理解必流於影響之談。漢代學者如鄭玄、許慎，其考據之精審，註疏之賅備，為後世樹立了不刊之典範。然訓詁非為終極目的，乃是通往義理之橋樑。學者當由小學入，而以通經致用為歸宿，避免陷入支離破碎的考證，而忽略了聖人立言之宏旨。",
    "魏晉清談，看似空疏，實則為思想解放之先聲。漢末以降，綱常崩壞，士人於亂世之中，既感無力，亦求精神之超越。遂轉向《老》《莊》與《周易》，探討有無、本末等玄學議題。竹林七賢之放浪形骸，正是對當時虛偽禮教的無聲抗議。此股思潮，深刻影響了當時的文學、藝術與價值觀，形成一種獨特的時代氣質，其歷史之功過，至今仍聚訟紛紜，未有定論。",
    "以符號學視角剖析商周饕餮紋，可見其為一高度濃縮之意義載體。其猙獰面目，並非單純的審美或裝飾，而是一個複雜的符碼系統，指向當時的宇宙觀與祭祀儀式。雙目巨口構成其視覺核心，象徵著與神靈溝通的權威與吞噬邪祟的力量。此紋飾作為溝通人神、區分內外的界線，其存在本身即是一種權力之宣示，亦是維繫社會秩序之精神圖騰，為研究上古心性與信仰之淵藪。",
    "論中國古典詩學之「意境」，乃是情與景、虛與實、言與意的完美交融。詩人觸景生情，復以情觀景，使客觀景物染上主觀色彩，從而創造出一個超越現實的藝術世界。王國維謂「意境」有「有我之境」與「無我之境」之別，實則點明了其綮肯。讀者涵泳其中，不僅能欣賞文字之美，更能與詩人之心靈產生共振，獲得一種審美體驗的昇華，此乃詩歌藝術之最高境界。",
    "古代朝堂之上，諍臣之存廢，常為國運興衰之表徵。所謂「諤諤者為上」，意指敢於直言進諫之臣，乃國之瑰寶。然忠言逆耳，人君能納者幾希？多數人主喜聽諛辭，而厭聞己過。是以，歷代諍臣如魏徵、海瑞，其命途多舛，非遭貶謫，即身陷囹圄。一個健康的政治生態，必須建立制度性的保障，使言者無罪，聞者足戒，方能避免壅蔽，實現長治久安。"
            ]
        ];

        let targetText = '';
        let isTyping = false;
        let startTime = null;
        let currentPosition = 0;
        let correctChars = 0;
        let totalChars = 0;
        let timer = null;

        // DOM elements
        const textDisplay = document.getElementById('textDisplay');
        const userInput = document.getElementById('userInput');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const difficultySelector = document.getElementById('difficultySelector');
        const wpmDisplay = document.getElementById('wpm');
        const accuracyDisplay = document.getElementById('accuracy');
        const timeDisplay = document.getElementById('time');
        const progressDisplay = document.getElementById('progress');

        // Initialize
        function init() {
            loadText();
            difficultySelector.addEventListener('change', loadText);
            startBtn.addEventListener('click', startTyping);
            resetBtn.addEventListener('click', resetTyping);
            userInput.addEventListener('input', handleInput);
        }

        // Load selected text
        function loadText() {
            currentDifficultyIndex = parseInt(difficultySelector.value);
            const array = practiceTextsByDifficulty[currentDifficultyIndex];
            const text = array[Math.floor(Math.random() * array.length)];
            targetText = text;
            displayText(text);
            resetTyping();
        }

        // Display text with character spans
        function displayText(text) {
            textDisplay.innerHTML = '';
            for (let i = 0; i < text.length; i++) {
                const span = document.createElement('span');
                span.textContent = text[i];
                span.id = `char-${i}`;
                textDisplay.appendChild(span);
            }
        }

        // Start typing session
        function startTyping() {
            isTyping = true;
            startTime = Date.now();
            currentPosition = 0;
            correctChars = 0;
            totalChars = 0;
            
            userInput.disabled = false;
            userInput.focus();
            userInput.value = '';
            
            startBtn.disabled = true;
            startBtn.textContent = '練習中... (Typing...)';
            
            // Highlight first character
            updateCurrentCharacter();
            
            // Start timer
            timer = setInterval(updateStats, 100);
        }

        // Reset typing session
        function resetTyping() {
            isTyping = false;
            startTime = null;
            currentPosition = 0;
            correctChars = 0;
            totalChars = 0;
            
            userInput.disabled = true;
            userInput.value = '';
            
            startBtn.disabled = false;
            startBtn.textContent = '開始練習 (Start)';
            
            // Reset all character styles
            const chars = textDisplay.querySelectorAll('span');
            chars.forEach(char => {
                char.className = '';
            });
            
            // Clear timer
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            // Reset stats
            wpmDisplay.textContent = '0';
            accuracyDisplay.textContent = '100%';
            timeDisplay.textContent = '0:00';
            progressDisplay.textContent = '0%';
        }

        // Handle user input
        function handleInput() {
            if (!isTyping) return;
            
            const userText = userInput.value;
            
            // Filter out intermediate Zhuyin characters - only count Chinese characters
            const chineseText = userText.replace(/[ㄅ-ㄩˊˇˋ˙]/g, '');
            
            totalChars = chineseText.length;
            correctChars = 0;
            
            // Check each character
            for (let i = 0; i < Math.max(chineseText.length, currentPosition); i++) {
                const charElement = document.getElementById(`char-${i}`);
                if (!charElement) continue;
                
                if (i < chineseText.length) {
                    if (chineseText[i] === targetText[i]) {
                        charElement.className = 'char-correct';
                        correctChars++;
                    } else {
                        charElement.className = 'char-incorrect';
                    }
                } else {
                    charElement.className = '';
                }
            }
            
            currentPosition = Math.max(chineseText.length, currentPosition);
            updateCurrentCharacter();
            
            // Check if completed
            if (chineseText === targetText) {
                updateStats();
                completeTyping();
            }
        }

        // Update current character highlight
        function updateCurrentCharacter() {
            const chars = textDisplay.querySelectorAll('span');
            chars.forEach((char, index) => {
                if (index === currentPosition && isTyping) {
                    if (!char.classList.contains('char-correct') && !char.classList.contains('char-incorrect')) {
                        char.classList.add('char-current');
                    }
                } else {
                    char.classList.remove('char-current');
                }
            });
        }

        // Complete typing session
        function completeTyping() {
            isTyping = false;
            startBtn.disabled = false;
            startBtn.textContent = '開始練習 (Start)';
            userInput.disabled = true;
            
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            // Remove current character highlight
            const chars = textDisplay.querySelectorAll('span');
            chars.forEach(char => {
                char.classList.remove('char-current');
            });
            
            // Show completion message
            setTimeout(() => {
                alert('恭喜完成！(Congratulations! You completed the text!)');
            }, 500);
        }

        // Update statistics
        function updateStats() {
            if (!isTyping || !startTime) return;
            
            const elapsedTime = (Date.now() - startTime) / 1000; // in seconds
            const minutes = elapsedTime / 60;
            
            // Calculate CPM (Characters Per Minute)
            const cpm = minutes > 0 ? Math.round(correctChars / minutes) : 0;
            
            // Calculate accuracy
            const accuracy = totalChars > 0 ? Math.round((correctChars / totalChars) * 100) : 100;
            
            // Calculate progress
            const targetLength = targetText.length;
            const progress = Math.round((currentPosition / targetLength) * 100);
            
            // Update display
            wpmDisplay.textContent = cpm;
            accuracyDisplay.textContent = `${accuracy}%`;
            timeDisplay.textContent = formatTime(elapsedTime);
            progressDisplay.textContent = `${progress}%`;
        }

        // Format time display
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Initialize the app
        init();
    </script>
</body>
</html>