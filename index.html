<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinese Zhuyin Typing Trainer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', 'Hiragino Sans GB', sans-serif;
            background-color: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-unit {
            font-size: 0.8em;
            color: #999;
        }

        .stat-value.speed { color: #3b82f6; }
        .stat-value.accuracy { color: #10b981; }
        .stat-value.time { color: #8b5cf6; }
        .stat-value.progress { color: #f59e0b; }

        .text-selector {
            margin-bottom: 30px;
        }

        .text-selector label {
            display: block;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .text-selector select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            background: white;
        }

        .text-selector select:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .text-display {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            line-height: 2.5;
            font-size: 1.4em;
            letter-spacing: 0.1em;
        }

        .char-correct {
            background-color: #dcfce7;
            color: #166534;
        }

        .char-incorrect {
            background-color: #fef2f2;
            color: #dc2626;
        }

        .char-current {
            background-color: #dbeafe;
            border-bottom: 3px solid #3b82f6;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .input-area {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .input-area label {
            display: block;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .input-area textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.2em;
            resize: none;
            font-family: 'Microsoft JhengHei', 'PingFang TC', 'Hiragino Sans GB', sans-serif;
            line-height: 1.6;
        }

        .input-area textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .input-area textarea:disabled {
            background-color: #f9fafb;
            cursor: not-allowed;
        }

        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-primary {
            background-color: #3b82f6;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background-color: #2563eb;
        }

        .btn-secondary {
            background-color: #6b7280;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background-color: #4b5563;
        }

        .instructions {
            background: #eff6ff;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #3b82f6;
        }

        .instructions h3 {
            color: #1e40af;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .instructions ul {
            color: #1e40af;
            list-style: none;
        }

        .instructions li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .instructions li:before {
            content: "•";
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .text-display {
                font-size: 1.2em;
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>中文注音打字練習</h1>
            <p>Chinese Zhuyin Typing Trainer</p>
        </div>

        <!-- Stats Panel -->
        <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-label">Speed</div>
                <div class="stat-value speed" id="wpm">0</div>
                <div class="stat-unit">CPM</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Accuracy</div>
                <div class="stat-value accuracy" id="accuracy">100%</div>
                <div class="stat-unit">Correct</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Time</div>
                <div class="stat-value time" id="time">0:00</div>
                <div class="stat-unit">Elapsed</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Progress</div>
                <div class="stat-value progress" id="progress">0%</div>
                <div class="stat-unit">Complete</div>
            </div>
        </div>

        <!-- Difficulty Selection -->
        <div class="text-selector">
            <label for="difficultySelector">選擇難度等級 (Select Difficulty Level)</label>
            <select id="difficultySelector">
                <option value="0">初級 (Beginner)</option>
                <option value="1">中級 (Intermediate)</option>
                <option value="2">高級 (Advanced)</option>
                <option value="3">專家級 (Expert)</option>
                <option value="4">母語/學術級 (Native/Academic)</option>
            </select>
        </div>

        <!-- Text Display -->
        <div class="text-display" id="textDisplay"></div>

        <!-- Input Area -->
        <div class="input-area">
            <label for="userInput">請使用注音輸入法輸入 (Type using Zhuyin IME)</label>
            <textarea 
                id="userInput" 
                rows="4" 
                placeholder="在這裡輸入中文字符..."
                disabled
            ></textarea>
        </div>

        <!-- Control Buttons -->
        <div class="controls">
            <button id="startBtn" class="btn btn-primary">
                開始練習 (Start)
            </button>
            <button id="resetBtn" class="btn btn-secondary">
                重新開始 (Reset)
            </button>
        </div>

        <!-- Instructions -->
        <div class="instructions">
            <h3>使用說明 (Instructions)</h3>
            <ul>
                <li>請確保您的系統已啟用注音輸入法</li>
                <li>看著上方的中文文本，使用注音輸入法在下方文本框中輸入</li>
                <li>系統會自動計算您的打字速度和準確率</li>
                <li>完成後可以選擇其他文本繼續練習</li>
            </ul>
        </div>
    </div>

    <script>
        // Practice texts organized by difficulty
        const practiceTextsByDifficulty = [
            // Level 0: Beginner
            [
                "大家好，我叫李明。我來自美國，現在住在臺北。我是一名英文老師。我的學校很大，學生都很可愛。我喜歡臺灣，因為臺灣人很友善，食物也很好吃。我最喜歡吃牛肉麵和珍珠奶茶。我正在學中文，我覺得中文有一點難，特別是寫字。我的愛好是看電影和聽音樂。很高興認識你們。",
                "我每天早上七點起床。起床以後，我先喝一杯水，然後做早餐。我通常吃麵包和雞蛋。八點半，我坐捷運去公司上班。我的工作很有意思。中午我和同事一起吃午飯。我們常常去公司附近的餐廳。下午五點我下班回家。晚上我喜歡在家看書或是跟朋友聊天。我大概十一點睡覺。",
                "老闆，你好。請問這個西瓜多少錢一斤？看起來很甜。好的，那我要買一個。另外，我還想買一些蘋果和香蕉。蘋果要五個，香蕉要一串。這裡的水果都很新鮮。對了，現在是芒果的季節嗎？如果是的話，我也想買兩個。謝謝你。總共多少錢？這是一千塊，請找錢。"
            ],
            // Level 1: Intermediate
            [
                "這個週末我打算和幾個朋友去陽明山走走。我們聽說最近天氣不錯，山上的風景應該會很漂亮。我們計畫早上搭公車上山，先去擎天崗看牛，然後沿著步道散步，享受大自然。中午我們會自己帶些簡單的三明治當午餐。因為我對攝影很有興趣，所以一定會帶相機去，希望能拍到一些滿意的照片。如果下山後還有時間，我們或許會去士林夜市逛逛，吃點道地的小吃。",
                "隨著工業發展，環境污染的問題變得越來越嚴重。無論是空氣污染、水污染，還是塑膠廢棄物，都對我們的地球造成了巨大的負擔。因此，實行環保生活是我們每個人的責任。我們可以從身邊的小事做起，例如隨手關燈、節約用水、做好垃圾分類，並且多使用環保袋，減少一次性塑膠製品。雖然個人的力量有限，但只要大家一起努力，就能為保護地球貢獻一份心力。",
                "我上週去看了一部廣受好評的懸疑電影。故事的結構非常巧妙，從一開始就營造出緊張的氣氛，讓觀眾完全投入其中。導演運用了許多非線性的敘事手法，不斷地在過去和現在之間切換，使得劇情更加撲朔迷離。演員的表現也相當出色，尤其主角把內心的掙扎與恐懼詮釋得淋漓盡致。電影的結局更是出人意料，顛覆了所有之前的猜測。總而言之，這是一部值得推薦的佳作。"
            ],
            // Level 2: Advanced
            [
                "現代都市猶如一頭永不歇息的巨獸，白日裡車水馬龍，夜晚則霓虹璀璨。人們在這片鋼筋水泥的叢林中奔波，為生活、為理想而奮鬥。然而，喧囂背後，這座城市亦有其靜謐的角落。或許是清晨公園裡打太極拳的長者，或許是隱身巷弄的獨立書店，又或許是黃昏時分，夕陽餘暉灑滿的河濱。在這些時刻，城市的節奏彷彿慢了下來，讓人得以喘息，重新審視內心，尋回那份久違的平靜與歸屬感。",
                "沉浸於書海之中，無異於進行一場跨越時空的深度對話。文字作為思想的載體，能引領我們窺探先哲的智慧，體悟不同時代的文化脈動。一本好書，或能啟迪心智，或能撫慰靈魂。當我們與書中人物共歷悲歡，隨作者的思緒遊走於奇妙的境地，世俗的煩惱似乎也隨之消散。這種純粹的精神享受，是其他娛樂方式難以比擬的。故曰，讀書之樂，樂在心領神會，樂在自我昇華。",
                "人工智能的崛起，正以前所未有的深度與廣度，重塑著人類社會的樣貌。從自動駕駛到醫療診斷，其應用已滲透至各行各業，極大提升了生產效率。然而，這項顛覆性的技術也帶來了諸多挑戰，例如大規模的失業風險、演算法的偏見問題，以及數據隱私與倫理的困境。我們正站在一個關鍵的十字路口，如何善用AI的潛力，同時建立健全的規範以防範其弊端，將是全人類刻不容緩的共同課題。"
            ],
            // Level 3: Expert
            [
                "秋氣蕭瑟，獨自彳亍於寂寥古道，看落葉蹣跚，隨風飄零。天穹高遠而湛藍，宛若一泓不起漣漪的清潭。遠山含黛，近水無言，萬物皆在凋敝中顯露其本真面目。此情此景，易引人愁思，然細品之下，未嘗不是一種侘傺之美。生命由絢爛歸於平淡，恰如這季節的更迭，蘊含著一種循環往復的哲理。人生在世，何嘗不似這秋葉，終將齎志而歿，歸於塵土？",
                "藝術之真諦，非在於纖毫畢現之摹寫，亦非純粹情感之宣洩，而在於捕捉那稍縱即逝之神韻與靈光。高明之藝術家，能以其獨特之慧眼，於平凡事物中洞見不凡，於剎那間凝住永恆。其作品或如晨鐘暮鼓，發人深省；或如空谷幽蘭，沁人心脾。觀者與作品交感之際，心靈得以滌蕩，境界得以提升。此種超越言筌的共鳴，正是藝術所以為藝術之精髓所在。",
                "探究歷史長河，常令人陷入偶然與必然的思辨。王朝之興替，英雄之崛起，看似皆有其必然的社會經濟背景與文化基因。然於關鍵節點，一場突如其來的瘟疫、一次偶然的軍事決策，或某位人物的性格缺陷，卻又可能如蝴蝶效應般，徹底扭轉歷史的軌跡。歷史彷彿在宏大的必然規律框架下，為無數微小的偶然性留下了恣意舞蹈的空間，其複雜與魅力，正在於此。"
            ],
            // Level 4: Native/Academic
            [
                "古籍之校勘，乃考據學之肯綮。一部典籍，歷經傳抄刊刻，訛誤增刪在所難免。校勘者之責，在於窮盡版本，比勘異同，溯其源流，以還其廬山真面目。此間功夫，非僅為辨識魯魚亥豕之誤，更需洞察時代之筆諱、書手之譌體，乃至後人之臆補。或有古字湮沒，為蠹魚所噬，僅存闕文，此時則需憑藉上下文與聲韻訓詁之學，審慎推求。此道甚艱，然為往聖繼絕學，雖千萬人吾往矣。",
                "商周青銅器之饕餮紋，其形詭譎，其意古奧，向為學界聚訟之焦點。其紋飾由簡至繁，由抽象至具象，演變軌跡清晰可辨。早期多為簡化之獸面，至商晚期則臻於繁縟，雙目圓睜，巨口獠牙，有吞噬天地之勢。究其意涵，或以為乃上古圖騰之孑遺，或以為象徵溝通天地之巫覡神獸。結合甲骨卜辭與祭祀禮制考之，饕餮或為一警示性符號，既代表對神明之敬畏，亦用以威嚇魑魅魍魎，以蠡測先民宇宙觀之一斑。",
                "《莊子·齊物論》乃道家思想之瓌寶。其核心要旨，在於破除人為的是非、彼此、大小之別，達至物我兩忘之境界。「天地與我並生，而萬物與我為一」，此非泯滅差異，而是超越對立的二元思維。當代社會，紛爭不斷，根源常在於固執己見，以自我為中心。莊子之智慧，恰可作一劑清涼散。若能從「道」之高度俯瞰，則一切價值判斷皆具相對性。體悟此理，方能放下執念，以逍遙之心，游刃於紛繁塵世。"
            ]
        ];

        let currentText = '';
        let isTyping = false;
        let startTime = null;
        let currentPosition = 0;
        let correctChars = 0;
        let totalChars = 0;
        let timer = null;

        // DOM elements
        const textDisplay = document.getElementById('textDisplay');
        const userInput = document.getElementById('userInput');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const difficultySelector = document.getElementById('difficultySelector');
        const wpmDisplay = document.getElementById('wpm');
        const accuracyDisplay = document.getElementById('accuracy');
        const timeDisplay = document.getElementById('time');
        const progressDisplay = document.getElementById('progress');

        // Initialize
        function init() {
            loadText();
            difficultySelector.addEventListener('change', loadText);
            startBtn.addEventListener('click', startTyping);
            resetBtn.addEventListener('click', resetTyping);
            userInput.addEventListener('input', handleInput);
        }

        // Load a random text based on selected difficulty
        function loadText() {
            const difficultyIndex = parseInt(difficultySelector.value);
            const textsForLevel = practiceTextsByDifficulty[difficultyIndex];
            const randomIndex = Math.floor(Math.random() * textsForLevel.length);
            currentText = textsForLevel[randomIndex];
            
            displayText(currentText);
            resetTyping();
        }

        // Display text with character spans
        function displayText(text) {
            textDisplay.innerHTML = '';
            text.split('').forEach((char, index) => {
                const span = document.createElement('span');
                span.textContent = char;
                span.id = `char-${index}`;
                textDisplay.appendChild(span);
            });
        }

        // Start typing session
        function startTyping() {
            isTyping = true;
            startTime = Date.now();
            currentPosition = 0;
            correctChars = 0;
            totalChars = 0;
            
            userInput.disabled = false;
            userInput.focus();
            userInput.value = '';
            
            startBtn.disabled = true;
            startBtn.textContent = '練習中... (Typing...)';
            
            updateCurrentCharacter();
            
            timer = setInterval(updateStats, 100);
        }

        // Reset typing session
        function resetTyping() {
            isTyping = false;
            startTime = null;
            currentPosition = 0;
            correctChars = 0;
            totalChars = 0;
            
            userInput.disabled = true;
            userInput.value = '';
            
            startBtn.disabled = false;
            startBtn.textContent = '開始練習 (Start)';
            
            const chars = textDisplay.querySelectorAll('span');
            chars.forEach(char => {
                char.className = '';
            });
            
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            wpmDisplay.textContent = '0';
            accuracyDisplay.textContent = '100%';
            timeDisplay.textContent = '0:00';
            progressDisplay.textContent = '0%';
        }

        // Handle user input
        function handleInput() {
            if (!isTyping) return;
            
            const userText = userInput.value;
            const targetText = currentText;
            const chineseText = userText.replace(/[ㄅ-ㄩˊˇˋ˙]/g, '');
            
            totalChars = chineseText.length;
            correctChars = 0;
            
            targetText.split('').forEach((targetChar, i) => {
                const charElement = document.getElementById(`char-${i}`);
                if (!charElement) return;

                if (i < chineseText.length) {
                    if (chineseText[i] === targetChar) {
                        charElement.className = 'char-correct';
                        correctChars++;
                    } else {
                        charElement.className = 'char-incorrect';
                    }
                } else {
                    charElement.className = ''; // Not yet typed
                }
            });
            
            currentPosition = chineseText.length;
            updateCurrentCharacter();
            
            if (chineseText === targetText) {
                updateStats();
                completeTyping();
            }
        }

        // Update current character highlight
        function updateCurrentCharacter() {
            const chars = textDisplay.querySelectorAll('span');
            chars.forEach((char, index) => {
                char.classList.remove('char-current');
            });
            if (isTyping && currentPosition < targetText.length) {
                const charElement = document.getElementById(`char-${currentPosition}`);
                 if (charElement) {
                    charElement.classList.add('char-current');
                 }
            }
        }

        // Complete typing session
        function completeTyping() {
            isTyping = false;
            startBtn.disabled = false;
            startBtn.textContent = '開始練習 (Start)';
            userInput.disabled = true;
            
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            const charElement = document.getElementById(`char-${currentPosition}`);
            if (charElement) {
                charElement.classList.remove('char-current');
            }
            
            setTimeout(() => {
                alert('恭喜完成！(Congratulations! You completed the text!)');
            }, 500);
        }

        // Update statistics
        function updateStats() {
            if (!isTyping || !startTime) return;
            
            const elapsedTime = (Date.now() - startTime) / 1000;
            const minutes = elapsedTime / 60;
            
            const cpm = minutes > 0 ? Math.round(correctChars / minutes) : 0;
            const accuracy = totalChars > 0 ? Math.round((correctChars / totalChars) * 100) : 100;
            const progress = Math.round((currentPosition / currentText.length) * 100);
            
            wpmDisplay.textContent = cpm;
            accuracyDisplay.textContent = `${accuracy}%`;
            timeDisplay.textContent = formatTime(elapsedTime);
            progressDisplay.textContent = `${progress}%`;
        }

        // Format time display
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        init();
    </script>
</body>
</html>